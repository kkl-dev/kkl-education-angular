<div class="container" *ngIf="questions.length > 0">
  <mat-grid-list cols="1" rowHeight="5vh">
    <mat-grid-tile rowspan="1">
      <app-form-header
        [text]="group.header.text"
        [custom]="group.header.custom"
        [slots]="{ gender, client, tourId }"
        [title]="true"
        class="header"
      >
      </app-form-header>
    </mat-grid-tile>

    <mat-grid-tile rowspan="10">
      <app-form-container
        [cols]="group.cols"
        [questions]="questions"
        [$questions]="$questions"
        [hasBottomButton]="true"
        [slots]="{ contact, payerName }"
        (valueChange)="logForm($event)"
      >
      </app-form-container>
    </mat-grid-tile>

    <mat-grid-tile class="row-height">
      <mat-grid-list
        *ngIf="hasBottom"
        [cols]="bottomData.length"
        rowHeight="5vh"
      >
        <mat-grid-tile *ngFor="let item of bottomData; let i = index">
          <div fxFill fxLayout="row" fxLayoutAlign="start center" dir="rtl">
            <div fxFlex="50">
              <app-typography size="14" class="label-text" [bold]="500">
                {{ item.label }}:
              </app-typography>
              <app-typography [bold]="600" size="14">
                {{ item.value }}
              </app-typography>
            </div>
            <div class="divider" fxFlex="20" *ngIf="i !== 0">|</div>
          </div>
        </mat-grid-tile>
      </mat-grid-list>
    </mat-grid-tile>
  </mat-grid-list>
</div>

<!-- template components -->

<ng-template #gender>
  <button
    mat-icon-button
    class="gender-button mat-elevation-z1"
    disableRipple="true"
    (click)="onGenderChange()"
  >
    <app-icon type="svg" key="gender" scale="2"></app-icon>
  </button>
</ng-template>

<ng-template #client>
  <app-typography
    fxLayoutAlign="end"
    class="client-text"
    color="primary"
    (click)="onAddClient()"
  >
    לקוח חדש
  </app-typography>
</ng-template>

<ng-template #tourId>
  <app-typography fxLayoutAlign="end"> קוד טיול : {{ tripId }} </app-typography>
</ng-template>

<ng-template #contact let-group="group" let-formGroup="formGroup">
  <mat-grid-list [cols]="group.cols" rowHeight="2vh">
    <mat-grid-tile
      *ngFor="let question of group.questions"
      [colspan]="question.cols"
      [rowspan]="question.rows"
    >
      <app-form-input
        class="group-input"
        [groupLabel]="question.key === 'girls' ? question.label : 'g'"
        [control]="formGroup.controls[group.key].controls[question.key]"
        [label]="question.label"
        [split]="cols > question.cols"
        [theme]="question.key === 'girls' && 'accent'"
        [type]="question.controlType"
      >
      </app-form-input>
    </mat-grid-tile>
  </mat-grid-list>
</ng-template>

<ng-template #payerName let-group="group" let-formGroup="formGroup">
  <mat-grid-list [cols]="group.cols" rowHeight="2vh">
    <mat-grid-tile
      *ngFor="let question of group.questions"
      [colspan]="question.cols"
      [rowspan]="question.rows || 2"
    >
      <app-form-input
        [control]="formGroup.controls[group.key].controls[question.key]"
        [label]="question.label"
        [disabled]="question.disabled"
        [split]="cols > question.cols"
        [type]="question.type"
        [label]="question.label"
        [icon]="question.icon"
        [options]="question.inputProps?.options"
        [dateOptions]="question.inputProps?.dateOptions"
        [controlType]="question.controlType"
        (autocomplete)="onAutocomplete($event)"
      >
      </app-form-input>
    </mat-grid-tile>
    <mat-grid-tile> working </mat-grid-tile>
  </mat-grid-list>
</ng-template>
